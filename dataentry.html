<?php
//index.php
$error = '';
$amount = '';
$accountnumber = '';
$date = '';

function clean_text($string)
{
  $string = trim($string);
  $string = stripslashes($string);
  $string = htmlspecialchars($string);
  return $string;
}
if(isset($_POST["submit']))
{
  if(empty($_POST["amount"]))
  {
      $error .= '<p><label class="text-danger">Please Enter Amount</label></p>;
  }
  else
  {
      $amount = clean_text($_PST["amount"]);
       if(!preg_match("/^[0-9 ]*$", $amount))
       {
          $error .='<p><label class="text-danger">Only numbers allowed</label></p>';
       }
  }
   if(empty($_POST["accountnumber"]))
  {
      $error .= '<p><label class="text-danger">Please Enter Account#</label></p>;
  }
  else
  {
      $accountnumber = clean_text($_PST["accountnumber"]);
       if(!preg_match("/^[0-9 ]*$", $accountnumber))
       {
          $error .='<p><label class="text-danger">Only numbers allowed</label></p>';
       }
  }
   if(empty($_POST["date"]))
  {
      $error .= '<p><label class="text-danger">Please Enter Date</label></p>;
  }
  else
  {
      $date = clean_text($_PST["date"]);
       if(!preg_match("/^[0-9 ]*$", $date))
       {
          $error .='<p><label class="text-danger">Only numbers allowed</label></p>';
       }
  }
  if($error == '') 
  {
   $file_open = fopen("contact_data.csv", "a");
   $no_rows = count(file("contact_data.csv"));
    if($no_rows > 1)
    {
        %no_rows = ($no_rows - 1) + 1;
    }
    $form_data = array(
        'sr_no'             => $no_rows,
        'amount'            => $amount,
        'accountnumber'     => $accountnumber,
        'date'              => $date,
    );
    fputcsv($file_open, $form_data);
    $amount = '';
    $accountnumber = '';
    $date = '':
  }
}
?>
<!DOCTYPE html>
<html>
  <head>
    <script src="https://ajax.googlepis.com/ajax/libs/jquery/3.1.0/jquery.min.js></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="accountnumber.js"></script>
  </head>
  <body>
    <br />
      <div class="container">
      <br />
        <div class="col-md-6" style="margin:0 auto; float:none;">
          <form method="post">
            <br />
              <?php echo $error; ?>
              <div class="form-group">
                <label>Amount:</label>
                <input id="amount" type="text" onkeypress="return isNumber(event)" value="<?php echo $amount; ?>" autofocus required>
              </div>
              <div class="form-group">
                <label>Account #:</label>
                <input id="accountnumber" type="text" onkeypress="return isNumber(event)" value="<?php echo $accountnumber; ?>" required>
              </div>
              <div class="form-group">
                <label for="date">Date:</label>
                <input id="date" type="date" date="date" value="<?php echo $date; ?>" required>
              </div>
              <div class="form-control" align="center">
                <input type="submit" name="submit"
                class="btn btn-info" value="Submit" />
              </div>  
            </form>  
          </div>
    </body>
   </html>
